{"request":[],"sendHeader":[{"enable":1,"name":"Font and CSS header Origin anonymizer - Request","ruleType":"modifySendHeader","matchType":"all","pattern":"","exclude":"","isFunction":true,"code":"if (detail.type === 'font' || detail.type === 'stylesheet' || detail.type === 'image') {\n\tfor (const header of val) {\n\t\tif (header.name.toLowerCase() === 'origin') {\n\t\t\theader.value = '';\n\t\t\tbreak;\n\t\t}\n\t}\n}\nif (detail.type === 'script') {\n\tconst domain = detail.url.split('/', 3)[2];\n\tif (domain.endsWith('cdn.vox-cdn.com')|| domain.endsWith('bootstrapcdn.com') || domain.endsWith('ajax.googleapis.com') || domain.endsWith('cdnjs.cloudflare.com')) {\n\t\tfor (const header of val) {\n\t\t\tif (header.name.toLowerCase() === 'origin') {\n\t\t\t\theader.value = '';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\nif (detail.type === 'xmlhttprequest' || detail.type === 'websocket') {\n\tconst domain = detail.url.split('/', 3)[2];\n\tif (domain.endsWith('hellomedian.com')) {\n\t\tfor (const header of val) {\n\t\t\tif (header.name.toLowerCase() === 'origin') {\n\t\t\t\theader.value = '';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}","id":5},{"enable":1,"name":"Log Origin when different domain","ruleType":"modifySendHeader","matchType":"all","pattern":"","exclude":"","isFunction":true,"code":"// https://www.peerlyst.com/posts/gdpr-does-the-right-to-erasure-include-backups-david-froud\n// https://medium.com/javascript-scene/javascript-es6-var-let-or-const-ba58b8dcde75\nif (detail.type === 'font' || detail.type === 'stylesheet' || detail.type === 'image') { return; }\n\nfor (const header of val) {\n//\tif (header.name.toLowerCase() === 'host') { var headerHost = header.value; }\n\tif (header.name.toLowerCase() === 'origin') {\n\t\tvar headerOrigin = header.value;\n\t\tbreak;\n\t}\n}\n\nif (headerOrigin === 'undefined') { return; }\n\nif (!(detail.url.split('/', 3)[2].endsWith(headerOrigin.split('//')[1].replace('www.','')))) {\n\tconsole.log(`ORIGIN_ALERT: ${detail.type.toUpperCase()}\n//H: ${headerHost}\nH: ${detail.url.split('/', 3)[2]}\nO: ${headerOrigin.split('/', 3)[2]}\nS: ${detail.originUrl}\nD: ${detail.url}\nO: ${headerOrigin}`\n\t);\n}\n","id":18}],"receiveHeader":[{"enable":1,"name":"remove ETag","ruleType":"modifyReceiveHeader","matchType":"all","pattern":"","exclude":"","isFunction":true,"code":"for (let a in val) {\n    if (val[a].name.toLowerCase() === 'etag') {\n        val[a].value = '';\n        break;\n    }\n}","id":1},{"enable":1,"name":"Font and CSS header Origin anonymizer - Response","ruleType":"modifyReceiveHeader","matchType":"all","pattern":"","exclude":"","isFunction":true,"code":"if (detail.type === 'font' || detail.type === 'stylesheet' || detail.type === 'image') {\n\tfor (const header of val) {\n\t\tif (header.name.toLowerCase() == 'access-control-allow-origin') {\n\t\t\tif (header.value == \"null\") { header.value = detail.originUrl.split('/', 3).join('/'); }\n\t\t\treturn;\n\t\t}\n\t}\n\tval.push({'name': 'Access-Control-Allow-Origin', 'value': detail.originUrl.split('/', 3).join('/')});\n}","id":6}]}